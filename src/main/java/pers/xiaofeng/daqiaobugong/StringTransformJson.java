package pers.xiaofeng.daqiaobugong;


import com.google.gson.Gson;
import com.google.gson.reflect.TypeToken;

import java.lang.reflect.Type;
import java.util.ArrayList;
import java.util.List;

/**
 * @description：byte[]、字符串转换为Json对象练习
 * @author：xiaofeng
 * @date：2020/11/4/22:03
 */
public class StringTransformJson {

    private static Gson gson = new Gson();

    public static void main(String[] args) {

        demo2();
    }

    private static void demo1() {
        /**
         * 注意：在将 byte[] 转换为 String 对象时，采用 new String() 而不是 byte.toString(),
         *      后者会出现问题
         */
        String str1 = "[{\"colId\":360,\"state\":0,\"target\":53,\"taskId\":297},{\"colId\":360,\"state\":0,\"target\":49,\"taskId\":298},{\"colId\":360,\"state\":0,\"target\":45,\"taskId\":299},{\"colId\":360,\"state\":0,\"target\":41,\"taskId\":300},{\"colId\":360,\"state\":0,\"target\":34,\"taskId\":301},{\"colId\":360,\"state\":0,\"target\":31,\"taskId\":302},{\"colId\":360,\"state\":0,\"target\":28,\"taskId\":303},{\"colId\":360,\"state\":0,\"target\":23,\"taskId\":308},{\"colId\":360,\"state\":0,\"target\":19,\"taskId\":309},{\"colId\":360,\"state\":0,\"target\":15,\"taskId\":310},{\"colId\":360,\"state\":0,\"target\":11,\"taskId\":311},{\"colId\":360,\"state\":0,\"target\":7,\"taskId\":312}]";
        byte[] aByte = {91, 123, 34, 99, 111, 108, 73, 100, 34, 58, 51, 54, 48, 44, 34, 115, 116, 97, 116, 101, 34, 58, 48, 44, 34, 116, 97, 114, 103, 101, 116, 34, 58, 53, 51, 44, 34, 116, 97, 115, 107, 73, 100, 34, 58, 50, 57, 55, 125, 44, 123, 34, 99, 111, 108, 73, 100, 34, 58, 51, 54, 48, 44, 34, 115, 116, 97, 116, 101, 34, 58, 48, 44, 34, 116, 97, 114, 103, 101, 116, 34, 58, 52, 57, 44, 34, 116, 97, 115, 107, 73, 100, 34, 58, 50, 57, 56, 125, 44, 123, 34, 99, 111, 108, 73, 100, 34, 58, 51, 54, 48, 44, 34, 115, 116, 97, 116, 101, 34, 58, 48, 44, 34, 116, 97, 114, 103, 101, 116, 34, 58, 52, 53, 44, 34, 116, 97, 115, 107, 73, 100, 34, 58, 50, 57, 57, 125, 44, 123, 34, 99, 111, 108, 73, 100, 34, 58, 51, 54, 48, 44, 34, 115, 116, 97, 116, 101, 34, 58, 48, 44, 34, 116, 97, 114, 103, 101, 116, 34, 58, 52, 49, 44, 34, 116, 97, 115, 107, 73, 100, 34, 58, 51, 48, 48, 125, 44, 123, 34, 99, 111, 108, 73, 100, 34, 58, 51, 54, 48, 44, 34, 115, 116, 97, 116, 101, 34, 58, 48, 44, 34, 116, 97, 114, 103, 101, 116, 34, 58, 51, 52, 44, 34, 116, 97, 115, 107, 73, 100, 34, 58, 51, 48, 49, 125, 44, 123, 34, 99, 111, 108, 73, 100, 34, 58, 51, 54, 48, 44, 34, 115, 116, 97, 116, 101, 34, 58, 48, 44, 34, 116, 97, 114, 103, 101, 116, 34, 58, 51, 49, 44, 34, 116, 97, 115, 107, 73, 100, 34, 58, 51, 48, 50, 125, 44, 123, 34, 99, 111, 108, 73, 100, 34, 58, 51, 54, 48, 44, 34, 115, 116, 97, 116, 101, 34, 58, 48, 44, 34, 116, 97, 114, 103, 101, 116, 34, 58, 50, 56, 44, 34, 116, 97, 115, 107, 73, 100, 34, 58, 51, 48, 51, 125, 44, 123, 34, 99, 111, 108, 73, 100, 34, 58, 51, 54, 48, 44, 34, 115, 116, 97, 116, 101, 34, 58, 48, 44, 34, 116, 97, 114, 103, 101, 116, 34, 58, 50, 51, 44, 34, 116, 97, 115, 107, 73, 100, 34, 58, 51, 48, 56, 125, 44, 123, 34, 99, 111, 108, 73, 100, 34, 58, 51, 54, 48, 44, 34, 115, 116, 97, 116, 101, 34, 58, 48, 44, 34, 116, 97, 114, 103, 101, 116, 34, 58, 49, 57, 44, 34, 116, 97, 115, 107, 73, 100, 34, 58, 51, 48, 57, 125, 44, 123, 34, 99, 111, 108, 73, 100, 34, 58, 51, 54, 48, 44, 34, 115, 116, 97, 116, 101, 34, 58, 48, 44, 34, 116, 97, 114, 103, 101, 116, 34, 58, 49, 53, 44, 34, 116, 97, 115, 107, 73, 100, 34, 58, 51, 49, 48, 125, 44, 123, 34, 99, 111, 108, 73, 100, 34, 58, 51, 54, 48, 44, 34, 115, 116, 97, 116, 101, 34, 58, 48, 44, 34, 116, 97, 114, 103, 101, 116, 34, 58, 49, 49, 44, 34, 116, 97, 115, 107, 73, 100, 34, 58, 51, 49, 49, 125, 44, 123, 34, 99, 111, 108, 73, 100, 34, 58, 51, 54, 48, 44, 34, 115, 116, 97, 116, 101, 34, 58, 48, 44, 34, 116, 97, 114, 103, 101, 116, 34, 58, 55, 44, 34, 116, 97, 115, 107, 73, 100, 34, 58, 51, 49, 50, 125, 93};
        byte[] bByte = {36, -55, -105, 0, 0, 0, 0, 0, 0, 1, -94, 0, 0, 0, 0, -11, -71, -67, 95, -88, -34, 0, 0, 0, 2, 0, -94, 0, 0, 0, 0, 0, 0, 0, 116, -88, 0, 0, 82, 65, 65, 1, 36, 1, 4, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 2, 3, 0, 0, 0, 0, 0, 1, 2, 30, 0, 43, 0, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 28, 0, 61, 32, 31, -8, 9, 0, 0, 0, 0, 0, 29, 0, 61, 32, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 42, 10, 0, 0, 0, 0, 8, 3, 24, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 70, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 23, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 26, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -64, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -63, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 27, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 22, 0, 61, 32, 31, -8, 9, 0, 0, 0, 0, 0, 24, 0, 62, 32, 0, 0, 0, 0, 0, 0, 0, 0, 23, 0, 62, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};

        // byte[] bytes = str.getBytes();
        String str2 = new String(aByte);
        // String str3 = aByte.toString();
        System.out.println(str2);
        Type taskListType = new TypeToken<List<Task>>() {
        }.getType();
        List<Task> tasks1 = gson.fromJson(str2, taskListType);
        System.out.println("json字符串转为Java对象列表完成！taskList1 = " + gson.toJson(tasks1));
        List<Task> tasks2 = new ArrayList<>();
        int i = 0;
        for (Task task : tasks1) {
            // System.out.println("【验证前】的Task{}" + i + " = " + gson.toJson(task));
            task.setState(10);
            tasks2.add(task);
            // System.out.println("【验证后】的Task{}" + i + " = " + gson.toJson(task));
            i++;
        }
        System.out.println("任务检查完成！返回给任务服的任务列表taskList2 = " + gson.toJson(tasks2));
        String str = gson.toJson(tasks2);
        System.out.println(gson.toJson(str.getBytes()));
    }

    /**
     * byte数组转字符串
     */
    private static void demo2() {
        byte[] aByte = {53, 48, 57, 52, 48, 50, 44, 52, 56, 48, 48, 44, 54, 57, 55, 56, 50, 44, 49, 124, 50, 53, 49, 51, 56, 55, 44, 45, 50, 52, 48, 48, 44, 53, 53, 50, 53, 44, 48, 124, 50, 53, 49, 51, 56, 56, 44, 45, 50, 52, 48, 48, 44, 53, 52, 51, 52, 44, 48};
        byte[] bByte = {53, 48, 57, 52, 48, 50, 44, 49, 52, 52, 48, 48, 44, 51, 50, 51, 49, 56, 50, 44, 49, 124, 50, 53, 49, 51, 57, 48, 44, 45, 50, 56, 56, 48, 48, 44, 50, 57, 49, 56, 54, 52, 44, 48, 124, 50, 53, 49, 51, 57, 49, 44, 49, 52, 52, 48, 48, 44, 51, 51, 53, 49, 49, 50, 44, 48};
        byte[] cByte = {36,0,0,0,0,0,0,0,0,0,0,0,58,0,0,57,-118,-51,95,81,-13,7,0,0,3,0,-30,1,0,0,63,31,0,0,111,17,0,0,-84,6,-30,1,36,29,37,6,0,0,0,0,0,0,0,0,0,63,31,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,29,37,6,0,-36,16,0,0,17,0,0,0,1,0,0,0,-75,-106,-104,0,-73,57,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};

        String str2 = new String(cByte);
        // String str3 = aByte.toString();
        System.out.println(str2);
    }

}

class Task {
    private int taskId;     // 任务id
    private int colId;      // 列id
    private int target;
    private int state;      // =10表示已完成，=0未完成

    public int getTaskId() {
        return taskId;
    }

    public void setTaskId(int taskId) {
        this.taskId = taskId;
    }

    public int getColId() {
        return colId;
    }

    public void setColId(int colId) {
        this.colId = colId;
    }

    public int getTarget() {
        return target;
    }

    public void setTarget(int target) {
        this.target = target;
    }

    public int getState() {
        return state;
    }

    public void setState(int state) {
        this.state = state;
    }
}